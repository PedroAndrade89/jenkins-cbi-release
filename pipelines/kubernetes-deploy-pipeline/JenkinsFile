pipeline {

    options {
      disableConcurrentBuilds()
      timeout(time: 40, unit: 'MINUTES') // Timeout
    }

    agent {
        label 'jenkins-slave'
    }

    environment {
        PATH = "/home/jenkins-slave/.local/bin/:${env.PATH}" // Add Ansible bin directory to PATH
        SECRET_NAME = "${env.cluster_name}-jenkins-sa-kubeconf" // Define the name of your secret in AWS Secrets Manager
        switch (${env.BRANCH_NAME}) {
          case 'qa':
            DIR='terraform/environments/qa'
            break;
          case 'prod':
            DIR='terraform/environments/prod'
            break;
          case 'stage':
            DIR='terraform/environments/stage'
            break;
    }

    stages {
        stage('Output Branch Name') {
            steps {
                echo "Currently building branch: ${env.BRANCH_NAME}"
            }
        }
          // Add other stages as needed
    }
    post {
      always {
        cleanWs()
      }
    }
}